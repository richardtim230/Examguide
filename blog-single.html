<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Blog Details | ExamGuard Nigeria Blog</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.js"></script>
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/2282/2282759.png">
  <style>
    html { scroll-behavior: smooth; }
    .section-title, h2 {
      font-size: 2.5rem !important;
      font-weight: 900 !important;
      line-height: 1.1;
      letter-spacing: -1px;
      color: #1e3a8a;
      margin-bottom: 2rem;
    }
    @media (max-width: 640px) {
      .section-title, h2 { font-size: 2rem !important; }
    }
    .navbar-spacer { height: 74px; }
    @media (min-width: 640px) {
      .navbar-spacer { height: 88px; }
    }
    .blog-content p { margin-bottom: 1.3em; line-height: 1.8; font-size: 1.12rem; }
    .blog-content h2, .blog-content h3 { margin-top: 2.2em; margin-bottom: 1em; font-weight: bold; color: #1e3a8a; font-size: 1.35rem; }
    .blog-content ul, .blog-content ol { margin-left: 1.5em; margin-bottom: 1.2em; }
    .blog-content li { margin-bottom: 0.8em; line-height: 1.7; font-size: 1.08rem; }
    .blog-content strong { color: #2563eb; }
    .blog-content { padding-top: 0.2em; padding-bottom: 0.2em; }
    @media (max-width: 640px) {
      .blog-content p, .blog-content li { font-size: 1rem; }
      .blog-content h2, .blog-content h3 { font-size: 1.1rem; }
    }
  </style>
</head>
<body class="bg-blue-50 text-blue-900">

  <!-- Navbar -->
  <nav class="bg-white/95 border-b border-blue-100 fixed w-full z-30 top-0 left-0 shadow-sm">
    <div class="container mx-auto flex flex-wrap items-center justify-between px-4 py-4 md:py-6">
      <a href="index.html" class="flex items-center gap-3">
        <img src="logo.png" class="h-10 md:h-12" alt="ExamGuard Logo">
        <span class="text-2xl md:text-3xl font-bold text-blue-700 tracking-tight leading-tight">ExamGuard<br><span class="block md:inline">Nigeria</span></span>
      </a>
      <button data-collapse-toggle="navbar-default" type="button" class="md:hidden ml-auto p-2 rounded-lg text-blue-800 hover:bg-blue-50 focus:outline-none" aria-controls="navbar-default">
        <svg class="w-7 h-7" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4 8h16M4 16h16"></path></svg>
      </button>
      <div class="hidden w-full md:flex md:items-center md:w-auto" id="navbar-default">
        <ul class="flex flex-col md:flex-row md:space-x-8 mt-4 md:mt-0 font-medium">
          <li><a href="index.html#features" class="block py-2 px-3 hover:text-blue-600 transition">Features</a></li>
          <li><a href="index.html#mock-exams" class="block py-2 px-3 hover:text-blue-600 transition">Mock Exams</a></li>
          <li><a href="index.html#codecxi" class="block py-2 px-3 hover:text-blue-600 transition">CODECX Institute</a></li>
          <li><a href="index.html#marketplace" class="block py-2 px-3 hover:text-blue-600 transition">Marketplace</a></li>
          <li><a href="blog.html" class="block py-2 px-3 hover:text-blue-600 transition font-bold text-blue-700">Blog & Earn</a></li>
          <li><a href="index.html#contact" class="block py-2 px-3 hover:text-blue-600 transition">Contact</a></li>
        </ul>
        <div class="flex space-x-2 mt-4 md:mt-0 md:ml-6">
          <a href="index.html#login" class="px-4 py-2 border border-blue-700 text-blue-700 rounded-lg hover:bg-blue-700 hover:text-white transition font-semibold">Login</a>
          <a href="index.html#register" class="px-4 py-2 bg-blue-700 text-white rounded-lg hover:bg-blue-900 transition font-semibold">Register</a>
        </div>
      </div>
    </div>
  </nav>
  <div class="navbar-spacer"></div>

  <!-- Blog Single Main Section -->
  <section class="w-full px-2 sm:px-4 py-8">
    <div class="max-w-3xl mx-auto bg-white rounded-2xl shadow-lg overflow-hidden">
      <div class="p-6 sm:p-10">
        <div id="blog-meta"></div>
        <h1 id="blog-title" class="text-2xl sm:text-3xl font-extrabold text-blue-900 mb-4 leading-tight"></h1>
        <div id="blog-author-date" class="flex flex-wrap items-center gap-3 mb-6 text-sm text-blue-900/70"></div>
        <img id="blog-image" class="rounded-xl shadow-md w-full h-64 object-cover mb-7" alt="Blog Cover" />
        <article id="blog-content" class="blog-content max-w-none text-lg leading-relaxed"></article>
        <div id="blog-tags" class="flex flex-wrap gap-3 mt-8"></div>
      </div>
    </div>
  </section>

  <!-- Related Posts (Optional) -->
  <section class="container mx-auto px-2 sm:px-4 py-10">
    <h2 class="section-title text-center">Related Articles</h2>
    <div id="related-blogs" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 max-w-5xl mx-auto"></div>
  </section>


                                                                         
  <script>
    // Responsive Navbar Toggle
    document.addEventListener('DOMContentLoaded', function () {
      const btn = document.querySelector('[data-collapse-toggle]');
      const menu = document.getElementById('navbar-default');
      btn?.addEventListener('click', () => {
        menu.classList.toggle('hidden');
      });

      // Utility: get blog data from localStorage, or fallback to blog.json
      function getBlogData() {
        const blogId = localStorage.getItem('selectedBlogId');
        let blog = null;
        let blogDataRaw = localStorage.getItem('selectedBlogData');
        if (blogDataRaw) {
          try { blog = JSON.parse(blogDataRaw); } catch {}
        }
        if (!blog || (blogId && blog.id && String(blog.id) !== String(blogId))) {
          return fetch('blog.json')
            .then(res => res.json())
            .then(data => {
              const found = data.find(b => String(b.id) === String(blogId));
              if (found) {
                localStorage.setItem('selectedBlogData', JSON.stringify(found));
                return found;
              }
              return null;
            })
            .catch(() => null);
        } else {
          return Promise.resolve(blog);
        }
      }

      // Sanitize blog content so script tags cannot break out
      function sanitizeHTML(html) {
        // Basic script tag removal for leakage prevention
        return typeof html === "string"
          ? html.replace(/<\/script>/gi, "&lt;/script&gt;").replace(/<script/gi, "&lt;script")
          : html;
      }

      // Render blog details
      function renderBlog(blog) {
        if (!blog) {
          document.getElementById('blog-title').innerText = 'Blog not found';
          document.getElementById('blog-content').innerHTML = "<p>Sorry, this blog post could not be loaded.</p>";
          document.getElementById('blog-image').src = "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=800&q=80";
          return;
        }
        document.getElementById('blog-meta').innerHTML = `
          <div class="flex flex-wrap items-center mb-5 gap-2">
            ${blog.university ? `<span class="bg-blue-100 text-blue-700 text-xs font-semibold px-3 py-1 rounded">${blog.university}</span>` : ""}
            ${blog.category ? `<span class="bg-gray-100 text-blue-900 text-xs font-semibold px-3 py-1 rounded">${blog.category}</span>` : ""}
            <span class="inline-flex items-center gap-1 text-yellow-500 text-sm font-semibold ml-auto">
              <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.957a1 1 0 00.95.69h4.159c.969 0 1.371 1.24.588 1.81l-3.37 2.448a1 1 0 00-.364 1.118l1.287 3.957c.3.921-.755 1.688-1.539 1.118l-3.37-2.448a1 1 0 00-1.175 0l-3.37 2.448c-.783.57-1.838-.197-1.539-1.118l1.287-3.957a1 1 0 00-.364-1.118L2.174 9.384c-.783-.57-.38-1.81.588-1.81h4.159a1 1 0 00.95-.69l1.286-3.957z"/>
              </svg>
              ${(blog.rating !== undefined && blog.rating !== null) ? blog.rating : '0.0'}
            </span>
          </div>
        `;
        document.getElementById('blog-title').innerText = blog.title || "Untitled";
        document.getElementById('blog-author-date').innerHTML = `
          <span>By <strong>${blog.author || "Anonymous"}</strong></span>
          <span>·</span>
          <span>Published: ${blog.date || "Unknown date"}</span>
          <span>·</span>
          <span>${blog.reads || 0} reads</span>
        `;
        document.getElementById('blog-image').src = blog.image || blog.image_url || "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=800&q=80";
        document.getElementById('blog-content').innerHTML = sanitizeHTML(blog.content || blog.excerpt || "<p>No content available.</p>");
        const tagsDiv = document.getElementById('blog-tags');
        if (Array.isArray(blog.tags)) {
          tagsDiv.innerHTML = blog.tags.map(tag =>
            `<span class="bg-blue-100 text-blue-700 rounded-full px-4 py-1 text-xs font-semibold">#${tag}</span>`
          ).join("");
        } else {
          tagsDiv.innerHTML = "";
        }
      }

      function renderRelated(blog) {
        let related = [];
        try {
          const relatedRaw = localStorage.getItem('relatedBlogs');
          if (relatedRaw) related = JSON.parse(relatedRaw);
        } catch {}
        function showRelated(data) {
          const relatedDiv = document.getElementById('related-blogs');
          let rel = [];
          if (Array.isArray(data)) {
            rel = data.filter(item => String(item.id) !== String(blog.id)).slice(0, 3);
          }
          if (rel.length) {
            relatedDiv.innerHTML = rel.map(item => `
              <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition duration-200 flex flex-col">
                <img src="${item.image || item.image_url || 'https://images.unsplash.com/photo-1510936111840-6c2d098e3c49?auto=format&fit=crop&w=600&q=80'}"
                  alt="${item.title}" class="w-full h-40 object-cover">
                <div class="p-5 flex flex-col flex-1">
                  <div class="flex items-center gap-2 mb-2">
                    ${item.university ? `<span class="bg-purple-100 text-purple-700 text-xs font-semibold px-2 py-1 rounded">${item.university}</span>` : ""}
                  </div>
                  <h3 class="font-bold text-lg mb-1">${item.title}</h3>
                  <a href="blog-single.html" onclick="selectBlog('${item.id}')" class="text-blue-700 font-semibold mt-auto hover:underline">Read More</a>
                </div>
              </div>
            `).join("");
          } else {
            relatedDiv.innerHTML = "<div class='text-blue-700 text-center col-span-3'>No related articles found.</div>";
          }
        }
        if (Array.isArray(related) && related.length) {
          showRelated(related);
        } else {
          fetch('blog.json')
            .then(res => res.json())
            .then(data => showRelated(data))
            .catch(() => {
              document.getElementById('related-blogs').innerHTML = "";
            });
        }
      }

      window.selectBlog = function(id) {
        let data = [];
        try {
          const raw = localStorage.getItem('relatedBlogs');
          if (raw) data = JSON.parse(raw);
        } catch {}
        function findAndNavigate(arr) {
          const found = arr.find(b => String(b.id) === String(id));
          if (found) {
            localStorage.setItem('selectedBlogId', id);
            localStorage.setItem('selectedBlogData', JSON.stringify(found));
          }
          window.location.href = "blog-single.html";
          return false;
        }
        if (Array.isArray(data) && data.length) {
          findAndNavigate(data);
        } else {
          fetch('blog.json')
            .then(res => res.json())
            .then(data => findAndNavigate(data))
            .catch(() => window.location.href = "blog-single.html");
        }
      };

      getBlogData().then(blog => {
        renderBlog(blog);
        if (blog) renderRelated(blog);
      });
    });
  </script>
</body>
</html>
