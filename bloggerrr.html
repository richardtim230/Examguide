<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OAU ExamGuard - Blogger/Marketer Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Quill Rich Text Editor CSS -->
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
    <style>
        html, body {
    width: 100%;
    max-width: 100vw;
    overflow-x: hidden;
}
body {
    font-family: 'Inter', sans-serif;
    background-color: #f9fafb;
}
.sidebar {
    background: linear-gradient(180deg, #4f46e5, #2dd4bf);
    position: fixed;
    top: 0;
    left: -100%;
    width: 80%;
    max-width: 270px;
    height: 100vh;
    overflow-y: auto;
    transition: left 0.3s ease;
    z-index: 50;
}
.sidebar.open {
    left: 0;
}
.sidebar-btn {
    transition: background-color 0.3s ease, transform 0.2s ease;
}
.sidebar-btn:hover,
.sidebar-btn.active {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.05);
}
.main-content {
    transition: margin-left 0.3s;
    width: 100%;
    max-width: 100vw;
    overflow-x: hidden;
}
.card {
    transition: transform 0.3s, box-shadow 0.3s;
    border-radius: 12px;
    overflow-x: auto;
}
.card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
}
.tab-content {
    display: none;
    animation: fadeIn 0.5s;
    max-width: 100vw;
    overflow-x: auto;
}
.tab-content.active {
    display: block;
}
.action-btn {
    transition: background-color 0.3s, transform 0.2s;
    white-space: nowrap;
}
.action-btn:hover {
    background: #5b21b6;
    transform: scale(1.05);
}
.modal {
    transition: opacity 0.3s, transform 0.3s;
    transform: scale(0.95);
    opacity: 0;
}
.modal.show {
    transform: scale(1);
    opacity: 1;
}
.modal-content {
    max-width: 95vw;
    width: 100%;
    overflow-x: auto;
}
.chart-container {
    max-height: 200px;
    width: 100%;
    overflow-x: auto;
}
.input-field {
    transition: box-shadow 0.3s;
    min-width: 0;
}
.input-field:focus {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}
.table-container {
    overflow-x: auto;
    width: 100%;
}
table {
    min-width: 600px;
    max-width: 100vw;
}
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px);}
    to { opacity: 1; transform: translateY(0);}
}
.fade-in {
    animation: fadeIn 0.5s ease forwards;
}
@media (min-width: 1024px) {
    .sidebar {
        position: sticky;
        left: 0;
        width: 250px;
    }
    .hamburger {
        display: none;
    }
    .main-content {
        margin-left: 250px;
    }
}
@media (max-width: 1023px) {
    .sidebar {
        padding: 1rem;
    }
    .sidebar-btn {
        font-size: 0.875rem;
        padding: 0.5rem 1rem;
    }
    .card h3 {
        font-size: 1.125rem;
    }
    .action-btn {
        font-size: 0.875rem;
        padding: 0.5rem 1rem;
    }
    .modal-content {
        width: 98vw;
        max-width: 98vw;
    }
    .chart-container {
        max-height: 150px;
    }
    .table-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    table {
        min-width: 600px;
    }
}

/* Overlay for closing sidebar on mobile when clicking outside */
@media (max-width: 1023px) {
    .sidebar-overlay {
        display: none;
        position: fixed;
        z-index: 40;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0,0,0,0.22);
    }
    .sidebar.open + .sidebar-overlay {
        display: block;
    }
}
    </style>
</head>
<body class="flex flex-col lg:flex-row min-h-screen w-full">
    <!-- Hamburger Menu -->
    <button id="hamburgerBtn" class="lg:hidden fixed top-4 left-4 z-50 p-2 bg-indigo-600 text-white rounded-full">
        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
    </button>

    <!-- Sidebar Navigation -->
    <aside class="sidebar text-white p-6">
        <div class="flex items-center mb-8">
            <img src="https://via.placeholder.com/40?text=Logo" alt="OAU ExamGuard Logo" class="h-10 w-10 mr-2">
            <h1 class="text-lg font-bold">Blogger/Marketer</h1>
        </div>
        <nav class="space-y-1">
            <button class="sidebar-btn w-full text-left px-4 py-2 rounded-lg text-sm lg:text-base active" data-tab="overview">Overview</button>
            <button class="sidebar-btn w-full text-left px-4 py-2 rounded-lg text-sm lg:text-base" data-tab="posts">Manage Posts</button>
            <button class="sidebar-btn w-full text-left px-4 py-2 rounded-lg text-sm lg:text-base" data-tab="analytics">Analytics</button>
            <button class="sidebar-btn w-full text-left px-4 py-2 rounded-lg text-sm lg:text-base" data-tab="followers">Followers</button>
            <button class="sidebar-btn w-full text-left px-4 py-2 rounded-lg text-sm lg:text-base" data-tab="marketplace">Marketplace</button>
            <button class="sidebar-btn w-full text-left px-4 py-2 rounded-lg text-sm lg:text-base" data-tab="earnings">Earnings</button>
            <button class="sidebar-btn w-full text-left px-4 py-2 rounded-lg text-sm lg:text-base" data-tab="profile">Profile Settings</button>
            <button class="sidebar-btn w-full text-left px-4 py-2 rounded-lg text-sm lg:text-base" data-tab="logout">Logout</button>
        </nav>
    </aside>
<div class="sidebar-overlay"></div>
    <!-- Main Content -->
    <main class="main-content flex-1 p-4 sm:p-6 bg-gray-50 w-full">
        <!-- Overview Tab -->
        <section id="overview" class="tab-content active">
            <header class="flex justify-between items-center mb-6 flex-wrap">
                <h2 class="text-2xl sm:text-3xl font-bold text-gray-800">Welcome, Sarah!</h2>
                <div class="flex items-center space-x-4">
                    <img src="https://via.placeholder.com/40?text=Profile" alt="Profile" class="h-10 w-10 rounded-full">
                </div>
            </header>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                <div class="card bg-white p-6 rounded-lg shadow-md fade-in">
                    <h3 class="text-lg font-semibold text-gray-800">Total Posts</h3>
                    <p class="text-2xl font-bold text-indigo-600">24</p>
                    <p class="text-sm text-gray-500">+2 this week</p>
                </div>
                <div class="card bg-white p-6 rounded-lg shadow-md fade-in">
                    <h3 class="text-lg font-semibold text-gray-800">Followers</h3>
                    <p class="text-2xl font-bold text-indigo-600">1,234</p>
                    <p class="text-sm text-gray-500">+45 this week</p>
                </div>
                <div class="card bg-white p-6 rounded-lg shadow-md fade-in">
                    <h3 class="text-lg font-semibold text-gray-800">Views</h3>
                    <p class="text-2xl font-bold text-indigo-600">15.6K</p>
                    <p class="text-sm text-gray-500">+1.2K this week</p>
                </div>
                <div class="card bg-white p-6 rounded-lg shadow-md fade-in">
                    <h3 class="text-lg font-semibold text-gray-800">Revenue</h3>
                    <p class="text-2xl font-bold text-indigo-600">‚Ç¶120,500</p>
                    <p class="text-sm text-gray-500">Marketplace sales</p>
                </div>
            </div>
            <!-- Quick Activity -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="card bg-white p-6 rounded-lg shadow-md">
                    <h4 class="font-bold mb-2 text-indigo-700">Recent Activity</h4>
                    <ul class="text-sm text-gray-600 space-y-2">
                        <li>‚úÖ Published blog post: <b>How to Ace Your Mock Exams</b></li>
                        <li>üõí Sold <b>Mathematics Notes</b> in marketplace</li>
                        <li>‚ûï Gained <b>20</b> new followers</li>
                    </ul>
                </div>
                <div class="card bg-white p-6 rounded-lg shadow-md">
                    <h4 class="font-bold mb-2 text-indigo-700">Tips</h4>
                    <ul class="text-sm text-gray-600 space-y-2">
                        <li>üí° Consistency is key. Post at least once a week.</li>
                        <li>üõçÔ∏è List quality study materials in marketplace.</li>
                        <li>üìà Share posts on social media for more reach.</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Manage Posts Tab (with Quill Rich Text Editor modal) -->
        <section id="posts" class="tab-content">
            <div class="flex flex-col sm:flex-row justify-between items-center mb-4">
                <h3 class="text-2xl font-bold text-gray-800 mb-2 sm:mb-0">Manage Posts</h3>
                <button id="createPostBtn" class="action-btn bg-indigo-600 text-white px-4 py-2 rounded-full text-sm sm:text-base">Create New Post</button>
            </div>
            <div class="mb-4 flex flex-col sm:flex-row justify-between items-center gap-2">
                <input id="postSearchInput" type="text" placeholder="Search posts..." class="input-field w-full sm:w-64 p-2 rounded-lg border border-gray-300">
                <span id="postCountLabel" class="text-gray-500 text-sm mt-1 sm:mt-0"></span>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md table-container">
                <table class="w-full text-left min-w-[600px]">
                    <thead>
                        <tr class="text-gray-600">
                            <th class="p-3">Title</th>
                            <th class="p-3">Date</th>
                            <th class="p-3">Views</th>
                            <th class="p-3">Status</th>
                            <th class="p-3">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="postTable"></tbody>
                </table>
                <div id="postPagination" class="mt-3 flex justify-end gap-2"></div>
            </div>
            <!-- Post Preview Modal -->
            <div id="postPreviewModal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
                <div class="modal-content bg-white p-6 rounded-lg w-full max-w-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Post Preview</h3>
                    <div id="previewTitle" class="text-lg font-semibold mb-2"></div>
                    <div id="previewDate" class="text-xs text-gray-500 mb-2"></div>
                    <div id="previewContent" class="text-base text-gray-700 quill-content"></div>
                    <div class="flex justify-end mt-4">
                        <button id="closePreviewBtn" class="action-btn bg-indigo-600 text-white px-4 py-2 rounded-full text-sm">Close</button>
                    </div>
                </div>
            </div>
            <!-- Create/Edit Post Modal with Quill Editor -->
            <div id="postModal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
                <div class="modal-content bg-white p-6 rounded-lg w-full max-w-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-4" id="postModalTitle">Create/Edit Post</h3>
                    <div class="space-y-4">
                        <input id="postTitle" type="text" placeholder="Post Title" class="input-field w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-600">
                        <div>
                            <label class="block text-sm font-semibold mb-1">Content</label>
                            <div id="quillEditor" style="height:180px;background:white"></div>
                        </div>
                        <select id="postStatus" class="input-field w-full p-3 rounded-lg border border-gray-300">
                            <option value="draft">Draft</option>
                            <option value="published">Published</option>
                        </select>
                        <div class="flex justify-end gap-2">
                            <button id="cancelPostBtn" class="action-btn bg-gray-300 text-gray-800 px-4 py-2 rounded-full text-sm">Cancel</button>
                            <button id="savePostBtn" class="action-btn bg-indigo-600 text-white px-4 py-2 rounded-full text-sm">Save</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Analytics Tab -->
        <section id="analytics" class="tab-content">
            <h3 class="text-2xl font-bold text-gray-800 mb-4">Analytics</h3>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                <div class="card bg-white p-6 rounded-lg shadow-md">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4">Views Over Time</h4>
                    <div class="chart-container w-full"><canvas id="viewsChart"></canvas></div>
                </div>
                <div class="card bg-white p-6 rounded-lg shadow-md">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4">Top Posts</h4>
                    <ul class="space-y-2" id="topPostsList"></ul>
                </div>
            </div>
        </section>
        <!-- Followers Tab -->
        <section id="followers" class="tab-content">
            <h3 class="text-2xl font-bold text-gray-800 mb-4">Followers</h3>
            <div class="bg-white p-6 rounded-lg shadow-md w-full max-w-full">
                <input type="text" placeholder="Search followers..." class="input-field w-full mb-4 p-2 rounded-lg border border-gray-300">
                <div class="flex flex-wrap gap-4" id="followersList"></div>
            </div>
        </section>
        <!-- Marketplace Tab -->
        <section id="marketplace" class="tab-content">
            <h3 class="text-2xl font-bold text-gray-800 mb-4">Marketplace Listings</h3>
            <div class="flex justify-end mb-3">
                <button class="action-btn bg-indigo-600 text-white px-4 py-2 rounded-full text-sm" id="addListingBtn">Add Listing</button>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md table-container">
                <table class="w-full text-left">
                    <thead>
                        <tr class="text-gray-600">
                            <th class="p-3">Item</th>
                            <th class="p-3">Price</th>
                            <th class="p-3">Status</th>
                            <th class="p-3">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="listingTable"></tbody>
                </table>
            </div>
        </section>
        <!-- Earnings Tab -->
        <section id="earnings" class="tab-content">
            <h3 class="text-2xl font-bold text-gray-800 mb-4">Earnings</h3>
            <div class="bg-white p-6 rounded-lg shadow-md mb-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <h4 class="font-semibold mb-2">Total Earnings</h4>
                        <p class="text-3xl font-bold text-indigo-600 mb-1">‚Ç¶120,500</p>
                        <p class="text-gray-500">From sales, referrals, and campaigns</p>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-2">Withdrawable Balance</h4>
                        <p class="text-2xl font-bold text-green-600 mb-1">‚Ç¶30,000</p>
                        <button class="action-btn bg-green-600 text-white px-4 py-2 rounded-full mt-2">Request Withdrawal</button>
                    </div>
                </div>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h4 class="font-semibold mb-4">Recent Transactions</h4>
                <div class="table-container">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="text-gray-600">
                                <th class="p-2">Date</th>
                                <th class="p-2">Type</th>
                                <th class="p-2">Amount</th>
                                <th class="p-2">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="p-2">2025-07-29</td>
                                <td class="p-2">Marketplace Sale</td>
                                <td class="p-2">‚Ç¶5,000</td>
                                <td class="p-2 text-green-600">Completed</td>
                            </tr>
                            <tr>
                                <td class="p-2">2025-07-25</td>
                                <td class="p-2">Referral Bonus</td>
                                <td class="p-2">‚Ç¶2,000</td>
                                <td class="p-2 text-green-600">Completed</td>
                            </tr>
                            <tr>
                                <td class="p-2">2025-07-20</td>
                                <td class="p-2">Withdrawal</td>
                                <td class="p-2">‚Ç¶10,000</td>
                                <td class="p-2 text-yellow-600">Pending</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        <!-- Profile Settings Tab -->
        <section id="profile" class="tab-content">
            <h3 class="text-2xl font-bold text-gray-800 mb-4">Profile Settings</h3>
            <div class="bg-white p-6 rounded-lg shadow-md max-w-xl">
                <form class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Full Name</label>
                        <input type="text" value="Sarah Ajayi" class="input-field w-full p-2 rounded-lg border border-gray-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Email</label>
                        <input type="email" value="sarah.ajayi@example.com" class="input-field w-full p-2 rounded-lg border border-gray-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Phone Number</label>
                        <input type="text" value="08012345678" class="input-field w-full p-2 rounded-lg border border-gray-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Bio</label>
                        <textarea class="input-field w-full p-2 rounded-lg border border-gray-300" rows="2">Passionate about student success and digital marketing.</textarea>
                    </div>
                    <button class="action-btn bg-indigo-600 text-white px-4 py-2 rounded-full mt-2">Save Changes</button>
                </form>
            </div>
        </section>
        <!-- Logout Tab -->
        <section id="logout" class="tab-content">
            <div class="flex flex-col items-center justify-center min-h-[40vh]">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">Logout</h3>
                <p class="text-gray-500 mb-6">Are you sure you want to logout?</p>
                <button class="action-btn bg-red-600 text-white px-6 py-3 rounded-full text-lg">Confirm Logout</button>
            </div>
        </section>
        <!-- Modal for Creating/Editing Listing -->
        <div id="listingModal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
            <div class="modal-content bg-white p-6 rounded-lg w-full max-w-lg">
                <h3 class="text-xl font-bold text-gray-800 mb-4">Add/Edit Listing</h3>
                <div class="space-y-4">
                    <input id="listingTitle" type="text" placeholder="Item Name" class="input-field w-full p-3 rounded-lg border border-gray-300">
                    <input id="listingPrice" type="number" min="0" placeholder="Price (‚Ç¶)" class="input-field w-full p-3 rounded-lg border border-gray-300">
                    <select id="listingStatus" class="input-field w-full p-3 rounded-lg border border-gray-300">
                        <option value="active">Active</option>
                        <option value="pending">Pending</option>
                    </select>
                    <div class="flex justify-end gap-2">
                        <button id="cancelListingBtn" class="action-btn bg-gray-300 text-gray-800 px-4 py-2 rounded-full text-sm">Cancel</button>
                        <button id="saveListingBtn" class="action-btn bg-indigo-600 text-white px-4 py-2 rounded-full text-sm">Save</button>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <!-- Quill Rich Text Editor JS (should be loaded in the JS file, NOT here) -->
    <script>
        // Hamburger menu and sidebar open/close with outside click
const sidebar = document.querySelector('.sidebar');
const hamburgerBtn = document.getElementById('hamburgerBtn');

// Create overlay for mobile sidebar close
let sidebarOverlay = document.querySelector('.sidebar-overlay');
if (!sidebarOverlay) {
    sidebarOverlay = document.createElement('div');
    sidebarOverlay.className = 'sidebar-overlay';
    sidebar.parentNode.insertBefore(sidebarOverlay, sidebar.nextSibling);
}
function closeSidebar() {
    sidebar.classList.remove('open');
    sidebarOverlay.style.display = 'none';
}
function openSidebar() {
    sidebar.classList.add('open');
    sidebarOverlay.style.display = 'block';
}
hamburgerBtn.addEventListener('click', function (e) {
    e.stopPropagation();
    openSidebar();
});
// Click outside sidebar closes it
sidebarOverlay.addEventListener('click', closeSidebar);
// Prevent click inside sidebar from closing
sidebar.addEventListener('click', function (e) {
    e.stopPropagation();
});
document.addEventListener('click', function (e) {
    // Only close sidebar if open and user clicks elsewhere (on small screens)
    if (window.innerWidth < 1024 && sidebar.classList.contains('open')) {
        closeSidebar();
    }
});

// Sidebar tab navigation
document.querySelectorAll('.sidebar-btn').forEach(btn => {
    btn.addEventListener('click', function () {
        document.querySelectorAll('.sidebar-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        const tab = this.dataset.tab;
        document.querySelectorAll('.tab-content').forEach(tabEl => {
            tabEl.classList.remove('active');
            if (tabEl.id === tab) tabEl.classList.add('active');
        });
        if (window.innerWidth < 1024) {
            closeSidebar();
        }
    });
});

// DATA (sample)
let postData = [
    { title: "Top 10 Study Hacks", date: "2025-07-10", views: 2500, status: "Published", content: "<p><strong>Here are my top 10 study hacks</strong> for students...</p>" },
    { title: "Coding Tips for Beginners", date: "2025-06-28", views: 1800, status: "Draft", content: "<h3>Start your coding journey by...</h3>" },
    { title: "Mastering Time Management", date: "2025-06-19", views: 1200, status: "Published", content: "<p>Time management is <em>essential</em> for success...</p>" },
    { title: "How to Take Notes Effectively", date: "2025-05-30", views: 950, status: "Published", content: "<ul><li>Be concise</li><li>Highlight key points</li></ul>" },
    { title: "Preparing for Finals", date: "2025-05-20", views: 2000, status: "Draft", content: "<p>Finals can be stressful. Here are some tips...</p>" },
    { title: "Best Study Environments", date: "2025-05-10", views: 750, status: "Draft", content: "<p>Find the right environment for focused studying...</p>" },
];
let listingData = [
    { item: "Calculus I Notes", price: 599, status: "Active" },
    { item: "USB-C Cable", price: 699, status: "Pending" }
];
let followersData = [
    { name: "Jane Doe", avatar: "https://via.placeholder.com/40?text=JD" },
    { name: "Mike Smith", avatar: "https://via.placeholder.com/40?text=MS" },
    { name: "Aisha Bello", avatar: "https://via.placeholder.com/40?text=AB" },
    { name: "John Paul", avatar: "https://via.placeholder.com/40?text=JP" }
];

// Manage Posts Tab Logic (with Quill)
const PAGE_SIZE = 5;
let postPage = 1;
let filteredPosts = postData.slice();

function renderPostTable(page = 1) {
    const start = (page - 1) * PAGE_SIZE, end = start + PAGE_SIZE;
    const rows = filteredPosts.slice(start, end).map((p, i) => `
        <tr class="border-t">
            <td class="p-3">${p.title}</td>
            <td class="p-3">${p.date}</td>
            <td class="p-3">${p.views}</td>
            <td class="p-3"><span class="text-${p.status === 'Published' ? 'green' : 'yellow'}-600">${p.status}</span></td>
            <td class="p-3 flex flex-wrap gap-2">
                <button class="preview-post action-btn bg-blue-500 text-white px-3 py-1 rounded text-xs" data-idx="${start + i}">Preview</button>
                <button class="edit-post action-btn bg-indigo-600 text-white px-3 py-1 rounded text-xs" data-idx="${start + i}">Edit</button>
                <button class="delete-post action-btn bg-red-600 text-white px-3 py-1 rounded text-xs" data-idx="${start + i}">Delete</button>
            </td>
        </tr>`).join('');
    document.getElementById('postTable').innerHTML = rows || `<tr><td colspan="5" class="text-gray-400 text-center py-7">No posts found.</td></tr>`;
    document.getElementById('postCountLabel').textContent = `${filteredPosts.length} post${filteredPosts.length !== 1 ? 's' : ''}`;
    renderPagination();
    attachPostActions();
}
function renderPagination() {
    const totalPages = Math.ceil(filteredPosts.length / PAGE_SIZE);
    const pagDiv = document.getElementById('postPagination');
    if (totalPages < 2) return pagDiv.innerHTML = '';
    pagDiv.innerHTML =
        `<button onclick="goToPostPage(1)" ${postPage === 1 ? 'disabled' : ''} class="px-2">First</button>` +
        `<button onclick="goToPostPage(${postPage - 1})" ${postPage === 1 ? 'disabled' : ''} class="px-2">&lt;</button>` +
        Array.from({ length: totalPages }, (_, i) => i + 1).map(i =>
            `<button onclick="goToPostPage(${i})" ${i === postPage ? 'class="text-indigo-600 font-bold"' : ''} class="px-2">${i}</button>`).join('') +
        `<button onclick="goToPostPage(${postPage + 1})" ${postPage === totalPages ? 'disabled' : ''} class="px-2">&gt;</button>` +
        `<button onclick="goToPostPage(${totalPages})" ${postPage === totalPages ? 'disabled' : ''} class="px-2">Last</button>`;
}
window.goToPostPage = function (page) {
    postPage = page;
    renderPostTable(page);
}
function attachPostActions() {
    document.querySelectorAll('.edit-post').forEach(btn => {
        btn.onclick = function () {
            const idx = +this.dataset.idx;
            openPostModal(idx);
        }
    });
    document.querySelectorAll('.delete-post').forEach(btn => {
        btn.onclick = function () {
            const idx = +this.dataset.idx;
            if (confirm('Delete this post?')) {
                postData.splice(idx, 1);
                filterAndRender();
            }
        }
    });
    document.querySelectorAll('.preview-post').forEach(btn => {
        btn.onclick = function () {
            const idx = +this.dataset.idx;
            openPreviewModal(idx);
        }
    });
}
function openPostModal(idx) {
    document.getElementById('postModal').classList.remove('hidden');
    document.getElementById('postModal').classList.add('show');
    document.getElementById('postModalTitle').textContent = idx != null ? "Edit Post" : "Create Post";
    const p = idx != null ? postData[idx] : { title: '', content: '', status: 'draft' };
    document.getElementById('postTitle').value = p.title;
    quill.setContents(p.content ? quill.clipboard.convert(p.content) : []);
    document.getElementById('postStatus').value = (p.status || 'draft').toLowerCase();
    document.getElementById('postModal').setAttribute('data-edit-idx', idx != null ? idx : '');
}
document.getElementById('cancelPostBtn').onclick = () => {
    document.getElementById('postModal').classList.remove('show');
    setTimeout(() => document.getElementById('postModal').classList.add('hidden'), 300);
};
document.getElementById('savePostBtn').onclick = () => {
    const title = document.getElementById('postTitle').value.trim();
    const content = quill.root.innerHTML.trim();
    const status = document.getElementById('postStatus').value === 'published' ? 'Published' : 'Draft';
    const idx = document.getElementById('postModal').getAttribute('data-edit-idx');
    if (title && content) {
        if (idx !== '') {
            postData[idx] = { ...postData[idx], title, content, status };
        } else {
            postData.unshift({ title, content, status, date: new Date().toISOString().slice(0, 10), views: 0 });
        }
        filterAndRender();
        document.getElementById('postModal').classList.remove('show');
        setTimeout(() => document.getElementById('postModal').classList.add('hidden'), 300);
    }
};
// Search/filter
document.getElementById('postSearchInput').oninput = function () {
    filterAndRender(this.value);
};
function filterAndRender(q = '') {
    filteredPosts = !q ? postData.slice() : postData.filter(p => p.title.toLowerCase().includes(q.toLowerCase()));
    postPage = 1;
    renderPostTable();
}
// Preview Modal
function openPreviewModal(idx) {
    const p = postData[idx];
    document.getElementById('previewTitle').textContent = p.title;
    document.getElementById('previewDate').textContent = p.date;
    document.getElementById('previewContent').innerHTML = p.content;
    document.getElementById('postPreviewModal').classList.remove('hidden');
    document.getElementById('postPreviewModal').classList.add('show');
}
document.getElementById('closePreviewBtn').onclick = () => {
    document.getElementById('postPreviewModal').classList.remove('show');
    setTimeout(() => document.getElementById('postPreviewModal').classList.add('hidden'), 300);
};
// Create new
document.getElementById('createPostBtn').onclick = () => openPostModal();

// Quill Editor initialization
let quill;
document.addEventListener("DOMContentLoaded", function () {
    quill = new Quill('#quillEditor', {
        modules: {
            toolbar: [
                [{ header: [1, 2, false] }],
                ['bold', 'italic', 'underline', 'strike'],
                [{ color: [] }, { background: [] }],
                [{ list: 'ordered' }, { list: 'bullet' }],
                [{ align: [] }],
                ['blockquote', 'code-block'],
                ['link', 'image'],
                ['clean']
            ]
        },
        placeholder: 'Write your post content here...',
        theme: 'snow'
    });
    // Initial render for posts
    renderPostTable();
});

// Analytics Tab (Chart.js)
if (window.Chart) {
    new Chart(document.getElementById('viewsChart'), {
        type: 'line',
        data: {
            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
            datasets: [{
                label: 'Views',
                data: [500, 600, 800, 700, 900, 1200, 1100],
                borderColor: '#4f46e5',
                backgroundColor: 'rgba(79, 70, 229, 0.2)',
                fill: true,
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            scales: { y: { beginAtZero: true } }
        }
    });
    // Top Posts
    const topPostsList = document.getElementById('topPostsList');
    if (topPostsList) {
        topPostsList.innerHTML = '';
        postData.slice(0, 3).forEach(post => {
            topPostsList.innerHTML += `<li class="text-gray-600">${post.title} - ${post.views} Views</li>`;
        });
    }
}

// Followers Tab
const followersList = document.getElementById('followersList');
if (followersList) {
    followersData.forEach(f => {
        followersList.innerHTML += `
        <div class="flex flex-col items-center min-w-[80px] max-w-[110px] w-full">
            <img src="${f.avatar}" alt="${f.name}" class="h-12 w-12 rounded-full mb-1">
            <span class="text-sm text-gray-700 truncate w-full text-center">${f.name}</span>
            <button class="action-btn bg-red-600 text-white px-2 py-1 rounded-full mt-1 text-xs">Remove</button>
        </div>
        `;
    });
}

// Marketplace Tab
function loadListings() {
    const listingTable = document.getElementById('listingTable');
    if (!listingTable) return;
    listingTable.innerHTML = '';
    listingData.forEach((item, idx) => {
        listingTable.innerHTML += `
        <tr class="border-t">
            <td class="p-3">${item.item}</td>
            <td class="p-3">‚Ç¶${item.price.toLocaleString()}</td>
            <td class="p-3"><span class="text-${item.status === 'Active' ? 'green' : 'yellow'}-600">${item.status}</span></td>
            <td class="p-3">
                <button class="edit-listing action-btn bg-indigo-600 text-white px-3 py-1 rounded text-sm mr-2" data-idx="${idx}">Edit</button>
                <button class="delete-listing action-btn bg-red-600 text-white px-3 py-1 rounded text-sm" data-idx="${idx}">Delete</button>
            </td>
        </tr>
        `;
    });
}
loadListings();
document.getElementById('addListingBtn')?.addEventListener('click', () => {
    const listingModal = document.getElementById('listingModal');
    listingModal.classList.remove('hidden');
    listingModal.classList.add('show');
    document.getElementById('listingTitle').value = '';
    document.getElementById('listingPrice').value = '';
    document.getElementById('listingStatus').value = 'active';
    listingModal.setAttribute('data-edit-idx', '');
});
document.getElementById('cancelListingBtn')?.addEventListener('click', () => {
    const listingModal = document.getElementById('listingModal');
    listingModal.classList.remove('show');
    setTimeout(() => listingModal.classList.add('hidden'), 300);
});
document.getElementById('saveListingBtn')?.addEventListener('click', () => {
    const title = document.getElementById('listingTitle').value;
    const price = +document.getElementById('listingPrice').value;
    const status = document.getElementById('listingStatus').value === 'active' ? 'Active' : 'Pending';
    const listingModal = document.getElementById('listingModal');
    const idx = listingModal.getAttribute('data-edit-idx');
    if (title && price) {
        if (idx) {
            listingData[idx] = { ...listingData[idx], item: title, price, status };
        } else {
            listingData.push({ item: title, price, status });
        }
        loadListings();
        attachListingActions();
        listingModal.classList.remove('show');
        setTimeout(() => listingModal.classList.add('hidden'), 300);
    }
});
function attachListingActions() {
    document.querySelectorAll('.edit-listing').forEach(btn => {
        btn.onclick = function () {
            const idx = this.getAttribute('data-idx');
            const l = listingData[idx];
            const listingModal = document.getElementById('listingModal');
            document.getElementById('listingTitle').value = l.item;
            document.getElementById('listingPrice').value = l.price;
            document.getElementById('listingStatus').value = l.status.toLowerCase();
            listingModal.classList.remove('hidden');
            listingModal.classList.add('show');
            listingModal.setAttribute('data-edit-idx', idx);
        };
    });
    document.querySelectorAll('.delete-listing').forEach(btn => {
        btn.onclick = function () {
            const idx = this.getAttribute('data-idx');
            if (confirm('Are you sure you want to delete this listing?')) {
                listingData.splice(idx, 1);
                loadListings();
                attachListingActions();
            }
        };
    });
}
attachListingActions();

// Logout
document.querySelector('#logout button')?.addEventListener('click', () => {
    alert('You have been logged out!');
    location.reload();
});
    </script>
</body>
</html>
