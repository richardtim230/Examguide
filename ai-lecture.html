<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Lecture: <span id="topicTitle"></span> | EduHub</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="logo.png">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    .outline-chip {
      transition: background 0.2s, color 0.2s, box-shadow 0.2s;
      cursor: pointer;
      user-select: none;
    }
    .outline-chip:hover, .outline-chip.active {
      background: linear-gradient(90deg,#6366f1,#3b82f6);
      color: #fff;
      box-shadow: 0 2px 8px #6366f133;
    }
    .section-title {
      font-size: 1.35rem;
      font-weight: 700;
      color: #312e81;
      background: linear-gradient(90deg,#e0e7ff 60%,#fff 100%);
      border-left: 5px solid #6366f1;
      border-radius: 0.5rem 0 0 0.5rem;
      padding: 0.6em 1em 0.6em 1.2em;
      margin: 2.2em 0 1.1em 0;
      box-shadow: 0 1px 6px #6366f124;
      letter-spacing: 0.01em;
    }
    .note-content {
      font-size: 1.14rem;
      line-height: 1.8;
      color: #1e293b;
      background: #f1f5fd;
      border-radius: 0.7em;
      margin-bottom: 1.6em;
      padding: 1.2em 1.5em 1.2em 1.5em;
      box-shadow: 0 1px 7px #6366f111;
    }
    .intro-section {
      background: #eef2ff;
      border-left: 4px solid #6366f1;
      border-radius: 0.8em;
      padding: 1.2em 1.5em;
      margin: 1.1em 0 2.2em 0;
      font-size: 1.13rem;
      color: #3730a3;
      box-shadow: 0 1px 6px #6366f133;
    }
    .main-container {
      max-width: 900px;
      margin: 0 auto;
      transition: background 0.4s;
    }
    .fade-in {
      animation: fadeIn 0.7s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px);}
      to { opacity: 1; transform: translateY(0);}
    }
    @media (max-width:600px){
      .main-container{padding:0.7em;}
      .note-content,.section-title,.intro-section{padding-left:0.8em;padding-right:0.8em;}
      #outlinesSidebar {display:none;}
      #outlinesNav {flex-direction: row!important; overflow-x: auto;}
    }
    .darkmode .main-container, .darkmode body {
      background: #020617 !important;
    }
    .darkmode .section-title {
      color: #f1f5fd;
      background: linear-gradient(90deg,#3730a3 60%,#020617 100%);
      border-left: 5px solid #818cf8;
      box-shadow: 0 1px 8px #6366f133;
    }
    .darkmode .note-content {
      background: #181f38;
      color: #e0e7ff;
    }
    .darkmode .intro-section {
      background: #181f38;
      color: #a5b4fc;
      border-left: 4px solid #818cf8;
    }
    .darkmode .outline-chip {
      background: #181f38 !important; color: #94a3b8 !important;
    }
    .darkmode .outline-chip.active, .darkmode .outline-chip:hover {
      background: linear-gradient(90deg,#6366f1,#3b82f6)!important; color:#fff!important;
    }
    .darkmode .flashcard {
      background: #232956;
      color: #f1f5fd;
    }
    .collapsible-content {display:none;}
    .collapsible.open .collapsible-content {display:block;}
    .collapsible-toggle {
      cursor:pointer; transition: background 0.2s;
    }
    .collapsible-toggle:hover {background: #e0e7ff;}
    .darkmode .collapsible-toggle:hover {background: #232956;}
    .progress-bar-bg {background: #e0e7ff;}
    .progress-bar-fg {background: linear-gradient(90deg,#6366f1,#0ea5e9);}
    .darkmode .progress-bar-bg {background:#232956;}
    .darkmode .progress-bar-fg {background: linear-gradient(90deg,#818cf8,#38bdf8);}
  </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 to-white min-h-screen font-sans transition-colors">
  <!-- HERO -->
  <header class="bg-white shadow-lg sticky top-0 z-30 transition-colors">
    <div class="main-container flex items-center gap-6 py-5">
      <a href="student-dashoards.html#study-resources" class="text-indigo-600 text-lg hover:underline flex items-center gap-2 font-semibold">
        <i class="fas fa-arrow-left"></i> Back
      </a>
      <div class="flex-1 text-center">
        <h1 id="topicTitle" class="text-3xl md:text-4xl font-extrabold text-indigo-900 tracking-tight drop-shadow-lg mb-1"></h1>
        <div class="inline-block bg-gradient-to-r from-indigo-100 via-blue-100 to-indigo-50 px-5 py-2 rounded-lg shadow text-indigo-800 font-bold text-base" id="topicLabel"></div>
      </div>
      <button id="darkModeBtn" class="text-indigo-700 border border-indigo-300 rounded-full px-3 py-2 font-bold focus:ring-2 focus:ring-indigo-400 transition hover:bg-indigo-50" title="Dark Mode"><i class="fas fa-moon"></i></button>
    </div>
    <div class="main-container flex justify-between items-center pb-3">
      <div class="hidden md:flex flex-col w-1/5 pr-4" id="outlinesSidebar"></div>
      <div class="flex-1">
        <div class="w-full h-2 rounded-full progress-bar-bg mb-2 overflow-hidden">
          <div id="progressBar" class="progress-bar-fg h-full rounded-full" style="width:0%"></div>
        </div>
      </div>
      <div style="width:2em;"></div>
    </div>
  </header>
  <main class="main-container fade-in py-3 px-2 flex gap-8">
    <!-- Desktop Outlines Sidebar -->
    <nav id="outlinesSidebar" class="hidden md:flex flex-col gap-3 sticky top-32 h-fit min-w-[180px]">
      <!-- Filled by JS -->
    </nav>
    <!-- Main Content -->
    <div class="flex-1">
      <!-- Mobile Outlines -->
      <nav id="outlinesNav" class="flex flex-wrap gap-3 mb-8 md:hidden"></nav>
      <!-- Introduction -->
      <section id="introduction" class="intro-section flex items-start gap-4">
        <div class="flex-shrink-0 text-4xl text-indigo-500"><i class="fas fa-lightbulb"></i></div>
        <div>
          <div id="introductionText"></div>
          <div id="introQuote" class="mt-3 italic text-indigo-800 text-base"></div>
        </div>
      </section>
      <!-- Flashcards Section -->
      <section id="flashcardsSection" class="mb-8">
        <div class="font-bold text-indigo-900 mb-2">Quick Flashcards</div>
        <div id="flashcards" class="flex flex-wrap gap-3"></div>
      </section>
      <!-- Notes rendered here -->
      <div id="notesContent"></div>
      <!-- Summary, Exam Tips -->
      <section class="border-t pt-5 mt-10">
        <div class="font-bold text-indigo-900 text-xl mb-2">Summary & Smart Exam Tips</div>
        <div class="note-content mb-3" id="summarySection"></div>
        <div class="bg-indigo-100 border-l-4 border-indigo-400 rounded-lg p-4 text-indigo-900 shadow mb-8" id="examTips"></div>
      </section>
      <!-- Action Bar -->
      <div class="flex flex-wrap gap-3 justify-end items-center mb-10 mt-6">
        <button onclick="window.print()" class="px-5 py-2 bg-indigo-500 text-white rounded shadow hover:bg-indigo-700 font-bold"><i class="fas fa-print mr-2"></i>Print</button>
        <button id="downloadBtn" class="px-5 py-2 bg-emerald-500 text-white rounded shadow hover:bg-emerald-700 font-bold"><i class="fas fa-download mr-2"></i>Download PDF</button>
        <button id="askMoreBtn" class="px-5 py-2 bg-blue-100 text-blue-800 rounded shadow hover:bg-blue-200 font-bold"><i class="fas fa-comments mr-2"></i>Ask More</button>
      </div>
    </div>
  </main>
  <footer class="main-container text-center text-gray-400 py-7 mt-12 text-sm">
    <hr class="mb-4">
    OAU ExamGuard AI Study Assistant &copy; 2025. For Nigerian University Students.
  </footer>
  <script>
    // --- Demo: Fetch topic from URL ---
    const params = new URLSearchParams(window.location.search);
    const topic = params.get("topic") || "Sample Topic";
    document.getElementById("topicTitle").textContent = topic;
    document.getElementById("topicLabel").textContent = "Lecture Note";

    // --- DEMO DATA: Replace with Gemini API result! ---
    const aiLectureData = {
      outlines: [
        "Definition and Overview",
        "Core Principles",
        "Practical Applications",
        "Challenges and Solutions",
        "Summary & Conclusion"
      ],
      introduction: "This topic introduces you to the fundamental concepts, principles, and practical aspects crucial for understanding and applying this subject area. The note is tailored to Nigerian university standards, ensuring clarity and relevance for your academic success.",
      introQuote: "“The beautiful thing about learning is that no one can take it away from you.” – B.B. King",
      notes: {
        "Definition and Overview": "In this section, we provide a detailed explanation of the topic, its history, and its overall importance. For example, if the topic is Photosynthesis, we explain its scientific definition, the discovery process, and its significance in the ecosystem.",
        "Core Principles": "Here, we break down the foundational laws, rules, or principles governing the topic. Examples and diagrams are given where helpful. For instance, we might discuss light-dependent and light-independent reactions in Photosynthesis.",
        "Practical Applications": "This part shows how the topic is applied in real life, both academically and practically in Nigeria. We discuss research, industry uses, and everyday relevance.",
        "Challenges and Solutions": "Common misconceptions, typical student mistakes, and strategies for mastering the topic are discussed here. We provide practical study tips and recommended resources specific to Nigerian contexts.",
        "Summary & Conclusion": "This wraps up the lecture with key takeaways, a motivational tip, and guidance for further study or exam revision."
      },
      flashcards: [
        {term: "Key Term 1", def: "Definition of key term 1 in simple language."},
        {term: "Key Term 2", def: "Definition of key term 2 for quick recall."},
        {term: "Key Term 3", def: "Definition of key term 3, explained clearly."}
      ],
      summary: "To sum up, this topic is vital for your academic journey because it builds a foundation for further learning and real-world application. Remember to review the core principles and practice with problem-solving questions.",
      examTips: [
        "Always start your answer with a clear definition.",
        "Use diagrams or examples relevant to the Nigerian context.",
        "Practice past questions on this topic for OAU and other Nigerian universities.",
        "Write your answers in clear, simple English.",
        "Revise regularly and discuss challenging concepts with classmates."
      ]
    };

    // --- Render Outlines Sidebar & Mobile Nav ---
    function renderOutlines() {
      const outlinesSidebar = document.getElementById("outlinesSidebar");
      const outlinesNav = document.getElementById("outlinesNav");
      outlinesSidebar.innerHTML = "";
      outlinesNav.innerHTML = "";
      aiLectureData.outlines.forEach((outline, idx) => {
        // Sidebar (desktop)
        let sideBtn = document.createElement("button");
        sideBtn.className = "outline-chip w-full px-4 py-3 mb-1 rounded-xl text-indigo-700 bg-indigo-50 font-semibold border-none shadow hover:shadow-lg transition-all text-left";
        sideBtn.innerHTML = `<i class="fas fa-circle-dot text-xs mr-2 text-indigo-400"></i> ${outline}`;
        sideBtn.onclick = () => {
          document.getElementById("section-" + idx).scrollIntoView({behavior:'smooth',block:'start'});
          document.querySelectorAll('#outlinesSidebar .outline-chip').forEach(c=>c.classList.remove('active'));
          sideBtn.classList.add('active');
          setTimeout(()=>sideBtn.classList.remove('active'),1200);
        }
        outlinesSidebar.appendChild(sideBtn);
        // Mobile
        let mobBtn = document.createElement("button");
        mobBtn.className = "outline-chip px-4 py-2 rounded-xl text-indigo-700 bg-indigo-100 font-semibold border-none shadow hover:shadow-lg transition-all";
        mobBtn.innerHTML = `<i class="fas fa-circle-dot text-xs mr-2 text-indigo-400"></i> ${outline}`;
        mobBtn.onclick = () => {
          document.getElementById("section-" + idx).scrollIntoView({behavior:'smooth',block:'start'});
          document.querySelectorAll('#outlinesNav .outline-chip').forEach(c=>c.classList.remove('active'));
          mobBtn.classList.add('active');
          setTimeout(()=>mobBtn.classList.remove('active'),1200);
        }
        outlinesNav.appendChild(mobBtn);
      });
      outlinesSidebar.classList.remove('hidden');
    }
    renderOutlines();

    // --- Render Introduction and Quote ---
    document.getElementById("introductionText").textContent = aiLectureData.introduction;
    document.getElementById("introQuote").textContent = aiLectureData.introQuote;

    // --- Render Flashcards ---
    const flashcardsDiv = document.getElementById("flashcards");
    aiLectureData.flashcards.forEach(card=>{
      let div = document.createElement("div");
      div.className = "flashcard bg-white border border-indigo-200 rounded-lg px-4 py-3 shadow font-semibold text-indigo-900 cursor-pointer transition hover:bg-indigo-50";
      div.tabIndex = 0;
      div.innerHTML = `<span>${card.term}</span>
        <div class="hidden mt-2 text-indigo-600 text-base">${card.def}</div>`;
      div.onclick = () => {
        let def = div.querySelector("div");
        def.classList.toggle("hidden");
      };
      div.onkeydown = (e) => {
        if(e.key==="Enter"||e.key===" "){div.click();}
      };
      flashcardsDiv.appendChild(div);
    });

    // --- Render Notes as Collapsible Panels ---
    const notesDiv = document.getElementById("notesContent");
    aiLectureData.outlines.forEach((outline, idx) => {
      // Section Title + Collapsible
      const section = document.createElement("section");
      section.id = "section-" + idx;
      section.className = "mb-9 collapsible";
      let isOpen = idx === 0; // first is open by default
      section.innerHTML = `
        <div class="section-title collapsible-toggle flex items-center justify-between cursor-pointer select-none ${isOpen?'bg-indigo-100':''}">
          <span>${outline}</span>
          <i class="fas fa-chevron-${isOpen?'down':'right'} text-indigo-400 transition"></i>
        </div>
        <div class="collapsible-content note-content"${isOpen?' style="display:block"':''}>${aiLectureData.notes[outline]}</div>
      `;
      notesDiv.appendChild(section);
    });

    // --- Collapsible logic ---
    document.querySelectorAll('.collapsible-toggle').forEach((toggle, idx) => {
      toggle.onclick = () => {
        const section = toggle.parentElement;
        const content = section.querySelector('.collapsible-content');
        const icon = toggle.querySelector('i');
        if (content.style.display === "block") {
          content.style.display = "none";
          icon.classList.replace('fa-chevron-down','fa-chevron-right');
        } else {
          content.style.display = "block";
          icon.classList.replace('fa-chevron-right','fa-chevron-down');
        }
      };
    });

    // --- Render Summary & Exam Tips ---
    document.getElementById("summarySection").textContent = aiLectureData.summary;
    document.getElementById("examTips").innerHTML = aiLectureData.examTips.map(tip=>`<li class="mb-1">${tip}</li>`).join('');

    // --- Progress Bar: Track scroll ---
    function updateProgressBar() {
      const main = document.querySelector('main');
      const scrollY = window.scrollY;
      const total = document.body.scrollHeight - window.innerHeight;
      let percent = Math.min(100, Math.round((scrollY / total) * 100));
      document.getElementById("progressBar").style.width = percent + "%";
    }
    window.addEventListener('scroll', updateProgressBar);

    // --- Download PDF (simple, for demo) ---
    document.getElementById("downloadBtn").onclick = function() {
      window.print();
    };

    // --- Ask More (open Google search for now) ---
    document.getElementById("askMoreBtn").onclick = function() {
      const q = encodeURIComponent(topic + " lecture for Nigerian university students");
      window.open("https://www.google.com/search?q=" + q, "_blank");
    };

    // --- Dark Mode Toggle ---
    document.getElementById("darkModeBtn").onclick = function() {
      document.body.classList.toggle("darkmode");
      document.querySelector("header").classList.toggle("bg-gray-900");
      document.querySelector("header").classList.toggle("bg-white");
    };

    // --- (Production) Replace aiLectureData above with your Gemini API result ---
    // fetch('/your-gemini-ai-endpoint?topic=' + encodeURIComponent(topic))
    //   .then(r=>r.json())
    //   .then(data=>{
    //     // Use data.outlines, data.introduction, data.notes, etc.
    //   });
  </script>
</body>
</html>
